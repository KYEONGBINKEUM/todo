(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[866],{4281:function(e,t,r){Promise.resolve().then(r.bind(r,1136))},1136:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var a=r(7573),l=r(7653),o=r(4193),s=r(9937),n=r(6921),d=r(1668),i=r(6307),c=r(2052),x=r(1676);let u=[{id:"my-tasks",label:"My Tasks",color:"#e94560"},{id:"work",label:"업무",color:"#8b5cf6"},{id:"personal",label:"개인",color:"#06b6d4"}],b={urgent:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500/30",label:"긴급"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500/30",label:"높음"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500/30",label:"보통"},low:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500/30",label:"낮음"}};function m(e){return[...e.matchAll(/@([\w가-힣]+)/g)].map(e=>e[1])}function p(){return new Date().toISOString().split("T")[0]}function h(){var e;let{user:t}=(0,o.a)(),{t:r}=(0,s.QT)(),{tasks:h,lists:g,loading:f}=(0,c.a)(),[v,y]=(0,l.useState)([]),[j,k]=(0,l.useState)(u),[N,w]=(0,l.useState)(""),[D,C]=(0,l.useState)(""),[S,T]=(0,l.useState)("medium"),[_,L]=(0,l.useState)(null),[P,E]=(0,l.useState)(null),[I,M]=(0,l.useState)(!1),[B,O]=(0,l.useState)(null),[J,A]=(0,l.useState)(p()),[F,U]=(0,l.useState)(!0),[H,K]=(0,l.useState)(null),[R,W]=(0,l.useState)(null),z=(0,l.useRef)(!1),[Q,Z]=(0,l.useState)(null),q=null!==(e=v.find(e=>e.id===Q))&&void 0!==e?e:null,G=function(){let e=new Date,t=[],r=["일","월","화","수","목","금","토"];for(let a=6;a>=0;a--){let l=new Date(e);l.setDate(e.getDate()-a),t.push({date:l,dateStr:l.toISOString().split("T")[0],day:l.getDate(),weekday:r[l.getDay()],isToday:0===a})}return t}();(0,d.D)(v),(0,l.useEffect)(()=>{if(z.current)return;let e=p();y([...h.filter(e=>e.myDay).filter(t=>"completed"!==t.status||t.completedDate===e)].sort((e,t)=>void 0!==e.order&&void 0!==t.order?e.order-t.order:void 0!==e.order?-1:void 0!==t.order?1:0).map((e,t)=>{var r;return{...e,order:null!==(r=e.order)&&void 0!==r?r:(t+1)*1e3}}))},[h]),(0,l.useEffect)(()=>{g.length>0&&(k(g),D||C(g[0].id))},[g]);let V=new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"}),X=v.filter(e=>!_||e.listId===_).filter(e=>{var t;return!P||(null!==(t=e.tags)&&void 0!==t?t:[]).includes(P)}),Y=X.filter(e=>"completed"!==e.status),$=X.filter(e=>"completed"===e.status),ee=X.filter(e=>"completed"===e.status).length,et=X.length,er=[...new Set(v.flatMap(e=>{var t;return null!==(t=e.tags)&&void 0!==t?t:[]}))].filter(Boolean),ea=!_&&!P,el=(e,t)=>{K(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",String(t))},eo=(e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",W(t)},es=()=>{K(null),W(null)},en=async(e,r)=>{if(e.preventDefault(),es(),null===H||H===r||z.current)return;let a=[...Y],[l]=a.splice(H,1);a.splice(r,0,l);let o=a.map((e,t)=>({...e,order:(t+1)*1e3}));if(y(o),t){z.current=!0;try{await Promise.all(o.map(e=>(0,n.xJ)(t.uid,e.id,{order:e.order})))}finally{z.current=!1}}},ed=async e=>{if(!t||!e.id)return;let r="completed"===e.status?"todo":"completed",a="completed"===r?p():null;await (0,n.xJ)(t.uid,e.id,{status:r,completedDate:a})},ei=async e=>{t&&e.id&&await (0,n.xJ)(t.uid,e.id,{starred:!e.starred})},ec=async()=>{if(!N.trim()||!t||I)return;M(!0);let e=N.trim(),r=m(e),a=v.reduce((e,t)=>{var r;return Math.max(e,null!==(r=t.order)&&void 0!==r?r:0)},0);w("");try{var l;await (0,n.gI)(t.uid,{title:e,status:"todo",priority:S,starred:!1,listId:D||(null===(l=j[0])||void 0===l?void 0:l.id)||"",myDay:!0,tags:r,order:a+1e3})}catch(e){O("할일 추가 실패")}finally{M(!1)}},ex=async e=>{var r;if(!t||!e.id)return;Q===e.id&&Z(null);let a=null!==(r=e.attachments)&&void 0!==r?r:[];a.length&&await (0,i.nd)(a),await (0,n._5)(t.uid,e.id)},eu=async e=>{if(!t||!Q)return;let r={...e};void 0!==e.title&&(r.tags=m(e.title)),"completed"===e.status&&(r.completedDate=p()),e.status&&"completed"!==e.status&&(r.completedDate=null),await (0,n.xJ)(t.uid,Q,r)},eb=e=>j.find(t=>t.id===e)||j[0]||u[0];return f?(0,a.jsx)("div",{className:"p-8 flex items-center justify-center min-h-[50vh]",children:(0,a.jsx)("div",{className:"w-6 h-6 border-2 border-[#e94560] border-t-transparent rounded-full animate-spin"})}):B?(0,a.jsx)("div",{className:"p-8 flex items-center justify-center min-h-[50vh]",children:(0,a.jsxs)("div",{className:"max-w-md text-center p-6 bg-red-500/10 border border-red-500/30 rounded-xl",children:[(0,a.jsx)("p",{className:"text-red-400 font-semibold mb-2",children:"오류 발생"}),(0,a.jsx)("p",{className:"text-text-secondary text-sm",children:B}),(0,a.jsx)("button",{onClick:()=>O(null),className:"mt-4 px-4 py-2 bg-[#e94560] text-white text-sm rounded-lg hover:bg-[#ff5a7a]",children:"닫기"})]})}):(0,a.jsxs)("div",{className:"p-4 md:p-8",children:[(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("span",{className:"text-3xl",children:"☀️"}),(0,a.jsx)("h2",{className:"text-3xl font-extrabold text-text-primary",children:r("myDay.title")})]}),(0,a.jsx)("p",{className:"text-text-secondary text-sm",children:V})]}),(0,a.jsx)("div",{className:"mb-6 p-3 bg-background-card border border-border rounded-xl",children:(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1.5",children:G.map(e=>(0,a.jsxs)("button",{onClick:()=>A(e.dateStr),className:"flex flex-col items-center py-2 rounded-xl transition-all ".concat(e.isToday?"bg-gradient-to-br from-[#e94560] to-[#533483] text-white shadow-lg shadow-[#e94560]/20":J===e.dateStr?"bg-[#e94560]/15 text-[#e94560] border border-[#e94560]/30":"text-text-secondary hover:bg-background-hover"),children:[(0,a.jsx)("span",{className:"text-[10px] font-medium mb-0.5",children:e.weekday}),(0,a.jsx)("span",{className:"text-lg font-bold ".concat(e.isToday?"text-white":""),children:e.day})]},e.dateStr))})}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-background-card border border-border rounded-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-text-secondary",children:r("myDay.progress")}),(0,a.jsxs)("span",{className:"text-sm font-bold text-[#e94560]",children:[ee,"/",et]})]}),(0,a.jsx)("div",{className:"w-full h-2.5 bg-border rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-[#e94560] to-[#533483] rounded-full transition-all duration-500",style:{width:"".concat(et>0?ee/et*100:0,"%")}})})]}),(0,a.jsxs)("div",{className:"mb-3 flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("button",{onClick:()=>L(null),className:"px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ".concat(_?"bg-background-card text-text-secondary border border-border hover:border-border-hover":"bg-[#e94560]/20 text-[#e94560] border border-[#e94560]/30"),children:r("common.all")}),j.map(e=>(0,a.jsxs)("button",{onClick:()=>L(_===e.id?null:e.id),className:"px-3 py-1.5 rounded-lg text-xs font-semibold transition-all flex items-center gap-1.5 ".concat(_===e.id?"bg-background-card border":"bg-background-card text-text-secondary border border-border hover:border-border-hover"),style:_===e.id?{borderColor:e.color,color:e.color}:void 0,children:[(0,a.jsx)("span",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),e.label]},e.id))]}),er.length>0&&(0,a.jsxs)("div",{className:"mb-4 flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("span",{className:"text-[10px] text-text-muted uppercase tracking-wider",children:"@태그"}),P&&(0,a.jsx)("button",{onClick:()=>E(null),className:"px-2.5 py-1 rounded-lg text-xs bg-background-card text-text-secondary border border-border hover:border-border-hover transition-all",children:r("common.all")}),er.map(e=>(0,a.jsxs)("button",{onClick:()=>E(P===e?null:e),className:"px-2.5 py-1 rounded-lg text-xs font-semibold transition-all border ".concat(P===e?"bg-[#8b5cf6]/15 text-[#8b5cf6] border-[#8b5cf6]/30":"text-text-secondary border-border hover:border-border-hover hover:bg-background-card"),children:["@",e]},e))]}),(0,a.jsxs)("div",{className:"mb-6 flex gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 flex bg-background-card border border-border rounded-xl overflow-hidden focus-within:border-[#e94560] transition-colors",children:[(0,a.jsx)("input",{type:"text",value:N,onChange:e=>w(e.target.value),onKeyDown:e=>"Enter"===e.key&&ec(),placeholder:r("myDay.addTask"),className:"flex-1 px-4 py-3 bg-transparent text-text-primary placeholder-text-muted text-sm focus:outline-none"}),(0,a.jsxs)("select",{value:S,onChange:e=>T(e.target.value),className:"px-2 bg-transparent text-xs border-l border-border focus:outline-none cursor-pointer text-text-secondary",children:[(0,a.jsx)("option",{value:"urgent",className:"bg-background-card",children:r("priority.urgent")}),(0,a.jsx)("option",{value:"high",className:"bg-background-card",children:r("priority.high")}),(0,a.jsx)("option",{value:"medium",className:"bg-background-card",children:r("priority.medium")}),(0,a.jsx)("option",{value:"low",className:"bg-background-card",children:r("priority.low")})]}),(0,a.jsx)("select",{value:D,onChange:e=>C(e.target.value),className:"px-2 bg-transparent text-text-secondary text-xs border-l border-border focus:outline-none cursor-pointer",children:j.map(e=>(0,a.jsx)("option",{value:e.id,className:"bg-background-card",children:e.label},e.id))})]}),(0,a.jsx)("button",{onClick:ec,disabled:I,className:"px-5 py-3 bg-[#e94560] hover:bg-[#ff5a7a] text-white font-semibold rounded-xl text-sm transition-colors disabled:opacity-50",children:I?"...":r("common.add")})]}),ea&&X.length>1&&(0,a.jsxs)("p",{className:"text-[10px] text-text-inactive mb-2 flex items-center gap-1",children:[(0,a.jsx)("span",{children:"⋮⋮"}),(0,a.jsx)("span",{children:r("myDay.dragHint")})]}),(0,a.jsx)("div",{className:"space-y-2",children:Y.map((e,t)=>{var r,l,o;let s=b[e.priority],n=eb(e.listId),d=Q===e.id,i=H===t,c=R===t,x=null!==(l=e.tags)&&void 0!==l?l:[];return(0,a.jsxs)("div",{draggable:ea,onDragStart:ea?e=>el(e,t):void 0,onDragOver:ea?e=>eo(e,t):void 0,onDrop:ea?e=>en(e,t):void 0,onDragEnd:es,onClick:()=>Z(d?null:e.id),className:"group flex items-center gap-3 p-4 bg-background-card border rounded-xl transition-all cursor-pointer select-none ".concat(i?"opacity-40 scale-95":c?"border-[#e94560] shadow-[0_0_12px_rgba(233,69,96,0.15)]":d?"border-[#e94560]/40 shadow-[0_0_12px_rgba(233,69,96,0.08)]":"border-border hover:border-border-hover"),style:{animation:c?void 0:"fadeUp 0.4s ease-out both",animationDelay:"".concat(.05*t,"s")},children:[ea&&(0,a.jsx)("span",{className:"opacity-0 group-hover:opacity-100 text-text-inactive text-xs cursor-grab active:cursor-grabbing flex-shrink-0 select-none",title:"드래그하여 순서 변경",children:"⋮⋮"}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),ed(e)},className:"w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all duration-300 flex-shrink-0 hover:border-[#e94560] hover:shadow-[0_0_8px_rgba(233,69,96,0.3)]",style:{borderColor:"var(--color-checkbox-border)"}}),(0,a.jsx)("span",{className:"w-1.5 h-8 rounded-full flex-shrink-0",style:{backgroundColor:n.color}}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("span",{className:"block text-sm text-text-primary",children:e.title}),x.length>0&&(0,a.jsx)("div",{className:"flex items-center gap-1 mt-0.5 flex-wrap",children:x.map(e=>(0,a.jsxs)("button",{onClick:t=>{t.stopPropagation(),E(P===e?null:e)},className:"text-[9px] px-1.5 py-0.5 rounded bg-[#8b5cf6]/10 text-[#8b5cf6] font-semibold hover:bg-[#8b5cf6]/20 transition-colors",children:["@",e]},e))})]}),(null!==(o=null===(r=e.subTasks)||void 0===r?void 0:r.length)&&void 0!==o?o:0)>0&&(0,a.jsxs)("span",{className:"text-[10px] text-text-muted flex-shrink-0",children:["\uD83D\uDCCB ",e.subTasks.filter(e=>e.completed).length,"/",e.subTasks.length]}),(0,a.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full border flex-shrink-0",style:{color:n.color,borderColor:"".concat(n.color,"40"),backgroundColor:"".concat(n.color,"10")},children:n.label}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-[10px] font-semibold border flex-shrink-0 ".concat(s.bg," ").concat(s.text," ").concat(s.border),children:s.label}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),ei(e)},className:"text-lg transition-all duration-200 flex-shrink-0 ".concat(e.starred?"text-amber-400":"text-text-inactive hover:text-amber-400/60"),children:e.starred?"★":"☆"}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),Z(e.id)},className:"opacity-0 group-hover:opacity-100 text-text-inactive hover:text-text-secondary transition-all flex-shrink-0",title:"상세 보기 / 편집",children:(0,a.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,a.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),ex(e)},className:"opacity-0 group-hover:opacity-100 text-text-inactive hover:text-[#e94560] transition-all text-lg flex-shrink-0",children:"\xd7"})]},e.id)})}),0===Y.length&&0===$.length&&(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("div",{className:"text-5xl mb-4",children:0===v.length?"☀️":P?"\uD83C\uDFF7️":"\uD83C\uDF89"}),(0,a.jsx)("p",{className:"text-text-secondary font-semibold",children:0===v.length?r("myDay.emptyAll"):P?"@".concat(P," ").concat(r("myDay.emptyTag")):r(_?"myDay.emptyList":"myDay.emptyComplete")})]}),$.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("button",{onClick:()=>U(!F),className:"flex items-center gap-2 text-text-muted text-sm mb-3 hover:text-text-secondary transition-colors w-full",children:[(0,a.jsx)("span",{className:"transition-transform duration-200 text-xs ".concat(F?"rotate-90":""),children:"▶"}),(0,a.jsx)("span",{className:"font-semibold",children:r("status.completed")}),(0,a.jsx)("span",{className:"text-[10px] bg-border px-2 py-0.5 rounded-full",children:$.length})]}),F&&(0,a.jsx)("div",{className:"space-y-2",children:$.map((e,t)=>{var r,l,o;let s=b[e.priority],n=eb(e.listId),d=Q===e.id,i=null!==(l=e.tags)&&void 0!==l?l:[];return(0,a.jsxs)("div",{onClick:()=>Z(d?null:e.id),className:"group flex items-center gap-3 p-4 bg-background-card border rounded-xl transition-all cursor-pointer opacity-60 ".concat(d?"border-[#e94560]/40":"border-border/50 hover:border-border-hover hover:opacity-80"),style:{animation:"fadeUp 0.3s ease-out both",animationDelay:"".concat(.03*t,"s")},children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),ed(e)},className:"w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all duration-300 flex-shrink-0 bg-gradient-to-br from-[#e94560] to-[#533483] border-transparent",children:(0,a.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:(0,a.jsx)("path",{d:"M3 7L6 10L11 4",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsx)("span",{className:"w-1.5 h-8 rounded-full flex-shrink-0",style:{backgroundColor:n.color}}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("span",{className:"block text-sm line-through text-text-inactive",children:e.title}),i.length>0&&(0,a.jsx)("div",{className:"flex items-center gap-1 mt-0.5 flex-wrap",children:i.map(e=>(0,a.jsxs)("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-[#8b5cf6]/10 text-[#8b5cf6]",children:["@",e]},e))})]}),(null!==(o=null===(r=e.subTasks)||void 0===r?void 0:r.length)&&void 0!==o?o:0)>0&&(0,a.jsxs)("span",{className:"text-[10px] text-text-muted flex-shrink-0",children:["\uD83D\uDCCB ",e.subTasks.filter(e=>e.completed).length,"/",e.subTasks.length]}),(0,a.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full border flex-shrink-0",style:{color:n.color,borderColor:"".concat(n.color,"40"),backgroundColor:"".concat(n.color,"10")},children:n.label}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-[10px] font-semibold border flex-shrink-0 ".concat(s.bg," ").concat(s.text," ").concat(s.border),children:s.label}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),ex(e)},className:"opacity-0 group-hover:opacity-100 text-text-inactive hover:text-[#e94560] transition-all text-lg flex-shrink-0",children:"\xd7"})]},e.id)})})]})]}),q&&(0,a.jsx)(x.Z,{task:q,onClose:()=>Z(null),onUpdate:eu,onDelete:()=>ex(q)})]})}}},function(e){e.O(0,[301,787,226,937,676,293,528,744],function(){return e(e.s=4281)}),_N_E=e.O()}]);