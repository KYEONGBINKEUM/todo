(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[751],{5189:function(e,t,n){Promise.resolve().then(n.bind(n,2256))},2256:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var l=n(6717),a=n(7387),r=n(1097),o=n(9936),i=n(6813);let s=["\uD83D\uDCCB","\uD83D\uDCAC","\uD83D\uDCA1","\uD83D\uDCDD","\uD83D\uDCD6","\uD83C\uDFAF","\uD83D\uDD2C","\uD83D\uDCCA","\uD83D\uDDC2️","✏️","\uD83E\uDDE0","⚡"],d=[{type:"text",icon:"T",label:"텍스트",desc:"일반 텍스트 블록",keywords:"text paragraph"},{type:"heading1",icon:"H1",label:"제목 1",desc:"큰 제목",keywords:"heading1 h1 title"},{type:"heading2",icon:"H2",label:"제목 2",desc:"중간 제목",keywords:"heading2 h2"},{type:"heading3",icon:"H3",label:"제목 3",desc:"작은 제목",keywords:"heading3 h3"},{type:"bullet",icon:"•",label:"글머리 목록",desc:"글머리 기호 목록",keywords:"bullet list unordered"},{type:"numbered",icon:"1.",label:"번호 목록",desc:"번호가 매겨진 목록",keywords:"numbered list ordered"},{type:"todo",icon:"☑",label:"할 일",desc:"체크리스트 항목",keywords:"todo checkbox check"},{type:"quote",icon:'"',label:"인용문",desc:"인용 블록",keywords:"quote blockquote"},{type:"code",icon:"</>",label:"코드",desc:"코드 블록",keywords:"code snippet"},{type:"link",icon:"\uD83D\uDD17",label:"링크",desc:"URL 링크 블록",keywords:"link url"},{type:"toggle",icon:"▶",label:"토글",desc:"접을 수 있는 블록",keywords:"toggle collapse expand"},{type:"divider",icon:"—",label:"구분선",desc:"수평 구분선",keywords:"divider line separator hr"}];function c(){let{user:e}=(0,r.a)(),{t}=(0,o.QT)(),[n,c]=(0,a.useState)([]),[u,p]=(0,a.useState)([]),[m,h]=(0,a.useState)(""),[b,g]=(0,a.useState)(""),[f,v]=(0,a.useState)(!1),[k,y]=(0,a.useState)(!1),[j,D]=(0,a.useState)(""),[w,N]=(0,a.useState)(!0),[C,S]=(0,a.useState)(null),[I,T]=(0,a.useState)(""),[E,_]=(0,a.useState)(new Set),[L,K]=(0,a.useState)(new Set),[P,O]=(0,a.useState)(null),[A,F]=(0,a.useState)(null),[M,R]=(0,a.useState)(!1),[q,z]=(0,a.useState)(null),[B,H]=(0,a.useState)(""),[W,Q]=(0,a.useState)(0),U=(0,a.useRef)(null),G=(0,a.useCallback)(async()=>{if(e)try{let[t,n]=await Promise.all([(0,i.Kk)(e.uid),(0,i.xh)(e.uid)]),l=t.map(e=>{var t,n,l,a,r,o;return{id:e.id,title:e.title,icon:e.icon,blocks:e.blocks,created_at:(null===(l=e.createdAt)||void 0===l?void 0:null===(n=l.toDate)||void 0===n?void 0:null===(t=n.call(l))||void 0===t?void 0:t.toISOString())||new Date().toISOString(),updated_at:(null===(o=e.updatedAt)||void 0===o?void 0:null===(r=o.toDate)||void 0===r?void 0:null===(a=r.call(o))||void 0===a?void 0:a.toISOString())||new Date().toISOString(),pinned:e.pinned,tags:e.tags,folderId:e.folderId,linkedTaskId:e.linkedTaskId||null,linkedTaskIds:e.linkedTaskIds||[]}});c(l),l.length>0&&h(l[0].id);let a=n.map(e=>({id:e.id,name:e.name,color:e.color,icon:e.icon}));p(a),_(new Set(a.map(e=>e.id)))}catch(e){console.error("Failed to load notes:",e)}finally{N(!1)}},[e]);(0,a.useEffect)(()=>{G()},[G]);let J=(0,a.useCallback)(async t=>{if(e)try{await (0,i.Qk)(e.uid,t.id,{title:t.title,icon:t.icon,blocks:t.blocks,pinned:t.pinned,tags:t.tags,folderId:t.folderId,linkedTaskId:t.linkedTaskId,linkedTaskIds:t.linkedTaskIds})}catch(e){console.error("Failed to save note:",e)}},[e]),V=n.find(e=>e.id===m),X=b?n.filter(e=>e.title.toLowerCase().includes(b.toLowerCase())||e.blocks.some(e=>e.content.toLowerCase().includes(b.toLowerCase()))):n,Y=(0,a.useRef)(null),Z=(0,a.useCallback)(e=>{Y.current&&clearTimeout(Y.current),Y.current=setTimeout(()=>{J(e)},400)},[J]),$=async t=>{let n=Date.now().toString(),l={id:n,title:"제목 없음",icon:"\uD83D\uDCDD",blocks:[{id:"".concat(Date.now(),"-b1"),type:"text",content:""}],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),pinned:!1,tags:[],folderId:null!=t?t:null,linkedTaskId:null,linkedTaskIds:[]};if(c(e=>[l,...e]),h(n),e)try{let t=await (0,i.AL)(e.uid,{title:l.title,icon:l.icon,blocks:l.blocks,pinned:l.pinned,tags:l.tags,folderId:l.folderId,linkedTaskId:l.linkedTaskId,linkedTaskIds:l.linkedTaskIds});c(e=>e.map(e=>e.id===n?{...e,id:t}:e)),h(t)}catch(e){console.error("Failed to create note:",e)}},ee=async t=>{if(c(e=>e.filter(e=>e.id!==t)),m===t){var l;h((null===(l=n.filter(e=>e.id!==t)[0])||void 0===l?void 0:l.id)||"")}if(e)try{await (0,i.f_)(e.uid,t)}catch(e){console.error("Failed to delete note:",e)}},et=e=>{c(t=>{let n=t.map(t=>t.id===m?{...t,title:e,updated_at:new Date().toISOString()}:t),l=n.find(e=>e.id===m);return l&&Z(l),n})},en=e=>{c(t=>{let n=t.map(t=>t.id===m?{...t,icon:e}:t),l=n.find(e=>e.id===m);return l&&Z(l),n}),v(!1)},el=e=>{c(t=>{let n=t.map(t=>t.id===e?{...t,pinned:!t.pinned}:t),l=n.find(t=>t.id===e);return l&&J(l),n})},ea=(e,t)=>{c(n=>{let l=n.map(n=>n.id===e?{...n,folderId:t}:n),a=l.find(t=>t.id===e);return a&&J(a),l})},er=async()=>{if(!j.trim())return;let t=["#e94560","#8b5cf6","#06b6d4","#22c55e","#f59e0b","#ec4899"],n=["\uD83D\uDCC1","\uD83D\uDCC2","\uD83D\uDDC2️","\uD83D\uDCE6"],l=Date.now().toString(),a={id:l,name:j.trim(),color:t[u.length%t.length],icon:n[u.length%n.length]};if(p(e=>[...e,a]),_(e=>new Set([...e,l])),D(""),y(!1),e)try{let t=await (0,i.oN)(e.uid,{name:a.name,color:a.color,icon:a.icon});p(e=>e.map(e=>e.id===l?{...e,id:t}:e)),_(e=>{let n=new Set(e);return n.delete(l),n.add(t),n})}catch(e){console.error("Failed to create folder:",e)}},eo=async t=>{if(!I.trim()){S(null);return}if(p(e=>e.map(e=>e.id===t?{...e,name:I.trim()}:e)),S(null),e)try{await (0,i.Tb)(e.uid,t,{name:I.trim()})}catch(e){console.error("Failed to rename folder:",e)}},ei=async t=>{if(c(e=>e.map(e=>e.folderId===t?{...e,folderId:null}:e)),p(e=>e.filter(e=>e.id!==t)),_(e=>{let n=new Set(e);return n.delete(t),n}),e)try{let l=n.filter(e=>e.folderId===t);await Promise.all(l.map(t=>(0,i.Qk)(e.uid,t.id,{folderId:null}))),await (0,i.Go)(e.uid,t)}catch(e){console.error("Failed to delete folder:",e)}},es=e=>{_(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},ed=(e,t)=>{c(n=>{let l=n.map(n=>n.id===m?{...n,updated_at:new Date().toISOString(),blocks:n.blocks.map(n=>n.id===e?{...n,content:t}:n)}:n),a=l.find(e=>e.id===m);return a&&Z(a),l})},ec=(e,t)=>{c(n=>{let l=n.map(n=>n.id===m?{...n,blocks:n.blocks.map(n=>n.id===e?{...n,...t}:n)}:n),a=l.find(e=>e.id===m);return a&&Z(a),l})},ex=e=>{c(t=>{let n=t.map(t=>t.id===m?{...t,blocks:t.blocks.map(t=>t.id===e?{...t,checked:!t.checked}:t)}:t),l=n.find(e=>e.id===m);return l&&Z(l),n})},eu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n={id:"".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,6)),type:t,content:"",..."todo"===t&&{checked:!1},..."toggle"===t&&{children:""}};c(t=>{let l=t.map(t=>{if(t.id!==m)return t;let l=t.blocks.findIndex(t=>t.id===e),a=[...t.blocks];return a.splice(l+1,0,n),{...t,blocks:a,updated_at:new Date().toISOString()}}),a=l.find(e=>e.id===m);return a&&Z(a),l}),setTimeout(()=>{let e=document.querySelector('[data-block-id="'.concat(n.id,'"]'));null==e||e.focus()},50)},ep=e=>{c(t=>{let n=t.map(t=>t.id!==m||t.blocks.length<=1?t:{...t,blocks:t.blocks.filter(t=>t.id!==e)}),l=n.find(e=>e.id===m);return l&&Z(l),n})},em=(e,t)=>{c(n=>{let l=n.map(n=>n.id===m?{...n,blocks:n.blocks.map(n=>n.id===e?{...n,type:t,..."todo"===t?{checked:!1}:{},..."toggle"===t?{children:""}:{},..."link"===t?{url:""}:{}}:n)}:n),a=l.find(e=>e.id===m);return a&&Z(a),l})},eh=d.filter(e=>{if(!B)return!0;let t=B.toLowerCase();return e.label.toLowerCase().includes(t)||e.keywords.includes(t)||e.type.includes(t)}),eb=e=>{q&&(em(q,e),ed(q,"")),R(!1),z(null),H(""),Q(0)},eg=(e,t)=>{if(M&&q===t.id){if("ArrowDown"===e.key){e.preventDefault(),Q(e=>Math.min(e+1,eh.length-1));return}if("ArrowUp"===e.key){e.preventDefault(),Q(e=>Math.max(e-1,0));return}if("Enter"===e.key){e.preventDefault(),eh[W]&&eb(eh[W].type);return}if("Escape"===e.key){e.preventDefault(),R(!1),z(null),H("");return}}if("Enter"===e.key&&!e.shiftKey){if(M)return;e.preventDefault();let n=["todo","bullet","numbered"].includes(t.type)?t.type:"text";eu(t.id,n)}if("Backspace"===e.key&&""===t.content&&(e.preventDefault(),"text"!==t.type?em(t.id,"text"):ep(t.id))," "===e.key&&"text"===t.type){let n=t.content;"#"===n?(em(t.id,"heading1"),ed(t.id,""),e.preventDefault()):"##"===n?(em(t.id,"heading2"),ed(t.id,""),e.preventDefault()):"###"===n?(em(t.id,"heading3"),ed(t.id,""),e.preventDefault()):"-"===n||"*"===n?(em(t.id,"bullet"),ed(t.id,""),e.preventDefault()):"1."===n?(em(t.id,"numbered"),ed(t.id,""),e.preventDefault()):"[]"===n||"[ ]"===n?(em(t.id,"todo"),ed(t.id,""),e.preventDefault()):">"===n?(em(t.id,"quote"),ed(t.id,""),e.preventDefault()):"---"===n?(em(t.id,"divider"),ed(t.id,""),e.preventDefault()):"```"===n?(em(t.id,"code"),ed(t.id,""),e.preventDefault()):"[["===n?(em(t.id,"link"),ed(t.id,""),e.preventDefault()):">>"===n&&(em(t.id,"toggle"),ed(t.id,""),e.preventDefault())}},ef=(e,t)=>{ed(e,t),"/"===t?(R(!0),z(e),H(""),Q(0)):t.startsWith("/")&&M&&q===e?(H(t.slice(1)),Q(0)):M&&q===e&&!t.startsWith("/")&&(R(!1),z(null),H(""))},ev=(e,t)=>{O(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",String(t))},ek=(e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",F(t)},ey=()=>{O(null),F(null)},ej=(e,t)=>{e.preventDefault(),ey(),null!==P&&P!==t&&V&&c(e=>{let n=e.map(e=>{if(e.id!==m)return e;let n=[...e.blocks],[l]=n.splice(P,1);return n.splice(t,0,l),{...e,blocks:n,updated_at:new Date().toISOString()}}),l=n.find(e=>e.id===m);return l&&Z(l),n})},eD=e=>{let t=new Date(e),n=Math.floor((Date.now()-t.getTime())/6e4),l=Math.floor(n/60),a=Math.floor(l/24);return n<1?"방금 전":n<60?"".concat(n,"분 전"):l<24?"".concat(l,"시간 전"):a<7?"".concat(a,"일 전"):t.toLocaleDateString("ko-KR",{month:"short",day:"numeric"})},ew=e=>{var t,n,a;let r="w-full bg-transparent outline-none resize-none text-text-primary placeholder-text-inactive";switch(e.type){case"heading1":return(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"제목 1",className:"".concat(r," text-3xl font-extrabold")});case"heading2":return(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"제목 2",className:"".concat(r," text-xl font-bold")});case"heading3":return(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"제목 3",className:"".concat(r," text-lg font-semibold")});case"bullet":return(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("span",{className:"text-[#e94560] mt-1 select-none text-lg leading-none",children:"•"}),(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"리스트 항목",className:"".concat(r," text-sm flex-1")})]});case"numbered":return(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("span",{className:"text-[#8b5cf6] text-sm mt-0.5 select-none min-w-[1.5em] text-right font-bold",children:(()=>{if(!V)return"1.";let t=V.blocks.filter(e=>"numbered"===e.type).findIndex(t=>t.id===e.id);return"".concat(t+1,".")})()}),(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"번호 목록",className:"".concat(r," text-sm flex-1")})]});case"todo":return(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)("button",{onClick:()=>ex(e.id),className:"w-5 h-5 mt-0.5 rounded-md border-2 flex items-center justify-center transition-all duration-300 flex-shrink-0 ".concat(e.checked?"bg-gradient-to-br from-[#e94560] to-[#533483] border-transparent":"hover:border-[#e94560]"),style:e.checked?void 0:{borderColor:"var(--color-checkbox-border)"},children:e.checked&&(0,l.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 14 14",fill:"none",children:(0,l.jsx)("path",{d:"M3 7L6 10L11 4",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"할 일",className:"".concat(r," text-sm flex-1 ").concat(e.checked?"line-through text-text-inactive":"")})]});case"quote":return(0,l.jsxs)("div",{className:"flex items-stretch gap-0 bg-[#e94560]/5 rounded-r-lg py-1",children:[(0,l.jsx)("div",{className:"w-[3px] bg-gradient-to-b from-[#e94560] to-[#533483] rounded-full flex-shrink-0 mr-3"}),(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"인용문",className:"".concat(r," text-sm italic text-text-secondary flex-1 bg-transparent")})]});case"divider":return(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)("div",{className:"h-px bg-gradient-to-r from-transparent via-border to-transparent"})});case"code":return(0,l.jsxs)("div",{className:"bg-background border border-border rounded-lg p-3 relative",children:[(0,l.jsx)("div",{className:"absolute top-2 right-2 text-[9px] text-text-inactive font-mono",children:"CODE"}),(0,l.jsx)("textarea",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>{"Enter"===t.key&&t.stopPropagation(),"Tab"===t.key&&(t.preventDefault(),ed(e.id,e.content+"  "))},placeholder:"코드를 입력하세요...",rows:Math.max(3,e.content.split("\n").length),className:"".concat(r," text-xs font-mono leading-relaxed resize-none")})]});case"link":return(0,l.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-background border border-border rounded-lg group",children:[(0,l.jsx)("span",{className:"text-[#3b82f6] flex-shrink-0",children:"\uD83D\uDD17"}),(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"링크 제목",className:"".concat(r," text-sm text-[#3b82f6] underline flex-1")}),(0,l.jsx)("input",{value:null!==(t=e.url)&&void 0!==t?t:"",onChange:t=>ec(e.id,{url:t.target.value}),placeholder:"https://...",className:"text-[11px] text-text-muted bg-transparent outline-none border-l border-border pl-2 w-40 shrink-0"}),e.url&&(0,l.jsx)("button",{onClick:()=>window.open(e.url,"_blank","noopener,noreferrer"),className:"text-[10px] px-2 py-0.5 bg-[#3b82f6]/20 text-[#3b82f6] rounded font-semibold flex-shrink-0",children:"열기"})]});case"toggle":return(0,l.jsxs)("div",{className:"rounded-lg overflow-hidden border border-border/60",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-background/50 cursor-pointer group/toggle",onClick:()=>K(t=>{let n=new Set(t);return n.has(e.id)?n.delete(e.id):n.add(e.id),n}),children:[(0,l.jsx)("span",{className:"text-text-muted transition-transform text-xs ".concat(L.has(e.id)?"rotate-90":""),children:"▶"}),(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>{t.stopPropagation(),ef(e.id,t.target.value)},onKeyDown:t=>{t.stopPropagation(),eg(t,e)},onClick:e=>e.stopPropagation(),placeholder:"토글 제목...",className:"".concat(r," text-sm font-semibold flex-1")})]}),L.has(e.id)&&(0,l.jsx)("div",{className:"px-3 py-2 border-t border-border/40 bg-background/20",children:(0,l.jsx)("textarea",{value:null!==(n=e.children)&&void 0!==n?n:"",onChange:t=>ec(e.id,{children:t.target.value}),placeholder:"내용을 입력하세요...",rows:Math.max(2,(null!==(a=e.children)&&void 0!==a?a:"").split("\n").length),className:"".concat(r," text-sm resize-none leading-relaxed")})})]});default:return(0,l.jsx)("input",{"data-block-id":e.id,value:e.content,onChange:t=>ef(e.id,t.target.value),onKeyDown:t=>eg(t,e),placeholder:"텍스트를 입력하세요... ( / 로 블록 타입 선택)",className:"".concat(r," text-sm")})}};if((0,a.useEffect)(()=>{if(!M)return;let e=e=>{U.current&&!U.current.contains(e.target)&&(R(!1),z(null))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[M]),w)return(0,l.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-8 h-8 border-2 border-[#e94560] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-text-secondary text-sm",children:t("common.loading")})]})});let eN=X.filter(e=>e.pinned),eC=e=>X.filter(t=>t.folderId===e&&!t.pinned),eS=X.filter(e=>null===e.folderId&&!e.pinned);return(0,l.jsxs)("div",{className:"flex h-screen",children:[(0,l.jsxs)("div",{className:"w-72 border-r border-border bg-background flex flex-col flex-shrink-0",children:[(0,l.jsxs)("div",{className:"p-4 border-b border-border",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-lg",children:"\uD83D\uDCDD"}),(0,l.jsx)("h2",{className:"text-lg font-bold text-text-primary",children:t("notes.title")}),(0,l.jsx)("span",{className:"text-xs text-text-muted bg-border px-2 py-0.5 rounded-full",children:X.length})]}),(0,l.jsx)("button",{onClick:()=>$(),className:"w-8 h-8 flex items-center justify-center bg-[#e94560] hover:bg-[#ff5a7a] text-white rounded-lg transition-colors text-lg",children:"+"})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-text-muted",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,l.jsx)("input",{type:"text",value:b,onChange:e=>g(e.target.value),placeholder:t("notes.search"),className:"w-full pl-9 pr-3 py-2 bg-background-card border border-border rounded-lg text-xs text-text-primary placeholder-text-muted focus:outline-none focus:border-[#e94560] transition-colors"})]})]}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto py-2",children:[eN.length>0&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsxs)("div",{className:"text-[9px] text-text-muted uppercase tracking-widest font-semibold px-4 py-1",children:["\uD83D\uDCCC ",t("notes.pinned")]}),eN.map(e=>(0,l.jsx)(x,{note:e,isActive:e.id===m,onClick:()=>h(e.id),onDelete:()=>ee(e.id),onTogglePin:()=>el(e.id),getRelativeTime:eD,indent:0},e.id))]}),u.map(e=>{let n=eC(e.id),a=E.has(e.id);return(0,l.jsxs)("div",{className:"mb-0.5",children:[(0,l.jsxs)("div",{className:"group flex items-center gap-1.5 px-3 py-1.5 hover:bg-background-card/60 transition-colors cursor-pointer rounded-lg mx-2",children:[(0,l.jsxs)("button",{onClick:()=>es(e.id),className:"flex items-center gap-1.5 flex-1 min-w-0",children:[(0,l.jsx)("span",{className:"text-text-muted transition-transform text-[10px] flex-shrink-0 ".concat(a?"rotate-90":""),children:"▶"}),(0,l.jsx)("span",{className:"text-sm flex-shrink-0",children:e.icon}),C===e.id?(0,l.jsx)("input",{value:I,onChange:e=>T(e.target.value),onBlur:()=>eo(e.id),onKeyDown:t=>{"Enter"===t.key&&eo(e.id),"Escape"===t.key&&S(null)},onClick:e=>e.stopPropagation(),autoFocus:!0,className:"flex-1 text-xs font-semibold bg-transparent outline-none border-b border-[#e94560] min-w-0",style:{color:e.color}}):(0,l.jsx)("span",{className:"text-xs font-semibold truncate flex-1",style:{color:e.color},onDoubleClick:t=>{t.stopPropagation(),S(e.id),T(e.name)},title:"더블클릭하여 이름 변경",children:e.name}),(0,l.jsx)("span",{className:"text-[10px] text-text-inactive flex-shrink-0",children:n.length})]}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),$(e.id),a||es(e.id)},className:"opacity-0 group-hover:opacity-100 w-5 h-5 flex items-center justify-center text-text-muted hover:text-[#e94560] transition-all text-sm",title:"이 폴더에 노트 추가",children:"+"}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),ei(e.id)},className:"opacity-0 group-hover:opacity-100 w-5 h-5 flex items-center justify-center text-text-muted hover:text-[#e94560] transition-all text-xs",title:"폴더 삭제",children:"\xd7"})]}),a&&n.map(e=>(0,l.jsx)(x,{note:e,isActive:e.id===m,onClick:()=>h(e.id),onDelete:()=>ee(e.id),onTogglePin:()=>el(e.id),getRelativeTime:eD,indent:1},e.id)),a&&0===n.length&&(0,l.jsx)("p",{className:"text-[11px] text-text-inactive pl-12 py-1",children:t("notes.noNotes")})]},e.id)}),eS.length>0&&(0,l.jsxs)("div",{className:"mt-1",children:[u.length>0&&(0,l.jsx)("div",{className:"text-[9px] text-text-muted uppercase tracking-widest font-semibold px-4 py-1 mt-2",children:t("notes.other")}),eS.map(e=>(0,l.jsx)(x,{note:e,isActive:e.id===m,onClick:()=>h(e.id),onDelete:()=>ee(e.id),onTogglePin:()=>el(e.id),getRelativeTime:eD,indent:0},e.id))]}),0===X.length&&(0,l.jsx)("div",{className:"text-center py-12 text-text-muted text-sm",children:b?"검색 결과가 없습니다":"노트가 없습니다"}),(0,l.jsx)("div",{className:"px-3 mt-3",children:k?(0,l.jsxs)("div",{className:"flex gap-1.5",children:[(0,l.jsx)("input",{type:"text",value:j,onChange:e=>D(e.target.value),onKeyDown:e=>"Enter"===e.key&&er(),placeholder:"폴더 이름...",autoFocus:!0,className:"flex-1 px-2.5 py-1.5 bg-background-card border border-border rounded-lg text-xs text-text-primary placeholder-text-muted focus:outline-none focus:border-[#e94560]"}),(0,l.jsx)("button",{onClick:er,className:"px-2.5 py-1.5 bg-[#e94560] text-white rounded-lg text-[10px] font-semibold",children:t("common.add")}),(0,l.jsx)("button",{onClick:()=>y(!1),className:"px-2 py-1.5 text-text-muted text-[10px]",children:t("common.cancel")})]}):(0,l.jsxs)("button",{onClick:()=>y(!0),className:"text-[11px] text-text-inactive hover:text-text-secondary transition-colors flex items-center gap-1",children:[(0,l.jsx)("span",{children:"+"})," ",t("notes.newFolder")]})})]})]}),V?(0,l.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-6 py-2.5 border-b border-border bg-background/50",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 text-xs text-text-muted",children:[(0,l.jsxs)("span",{children:["수정됨 ",eD(V.updated_at)]}),(0,l.jsx)("span",{children:"\xb7"}),(0,l.jsxs)("span",{children:[V.blocks.length," 블록"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[[{type:"text",label:"T",title:"텍스트"},{type:"heading2",label:"H",title:"제목"},{type:"bullet",label:"•",title:"글머리"},{type:"todo",label:"☑",title:"할 일"},{type:"quote",label:'"',title:"인용"},{type:"code",label:"</>",title:"코드"},{type:"link",label:"\uD83D\uDD17",title:"링크 ([[)"},{type:"toggle",label:"▶",title:"토글 (>>)"},{type:"divider",label:"—",title:"구분선"}].map(e=>(0,l.jsx)("button",{onClick:()=>{eu(V.blocks[V.blocks.length-1].id,e.type)},title:e.title,className:"w-7 h-7 flex items-center justify-center text-text-inactive hover:text-text-primary hover:bg-border rounded transition-colors text-[11px] font-mono",children:e.label},e.type)),(0,l.jsx)("div",{className:"w-px h-4 bg-border mx-1"}),(0,l.jsxs)("select",{value:V.folderId||"",onChange:e=>ea(V.id,e.target.value||null),className:"h-7 px-2 bg-background-card text-text-muted text-[10px] border border-border rounded-lg focus:outline-none cursor-pointer",children:[(0,l.jsx)("option",{value:"",children:"폴더 없음"}),u.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id))]})]})]}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto px-8 py-6",children:(0,l.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"relative inline-block mb-2",children:[(0,l.jsx)("button",{onClick:()=>v(!f),className:"text-4xl hover:scale-110 transition-transform",children:V.icon}),f&&(0,l.jsx)("div",{className:"absolute top-12 left-0 bg-background-card border border-border rounded-xl p-3 shadow-xl z-10 min-w-[240px]",children:(0,l.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 36px)",gap:"4px"},children:s.map(e=>(0,l.jsx)("button",{onClick:()=>en(e),style:{width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",borderRadius:"8px"},className:"hover:bg-border transition-colors",children:e},e))})})]}),(0,l.jsx)("input",{value:V.title,onChange:e=>et(e.target.value),placeholder:"제목 없음",className:"w-full bg-transparent text-3xl font-extrabold text-text-primary placeholder-text-inactive outline-none"}),(0,l.jsx)("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:V.tags.map(e=>(0,l.jsx)("span",{className:"px-2.5 py-0.5 bg-[#e94560]/10 text-[#e94560] text-[10px] font-semibold rounded-full border border-[#e94560]/20",children:e},e))})]}),(0,l.jsx)("div",{className:"space-y-0.5 relative",children:V.blocks.map((e,t)=>(0,l.jsxs)("div",{draggable:!0,onDragStart:e=>ev(e,t),onDragOver:e=>ek(e,t),onDrop:e=>ej(e,t),onDragEnd:ey,className:"group relative py-1.5 px-1 -mx-1 rounded transition-colors ".concat(P===t?"opacity-40 scale-95":A===t?"bg-[#e94560]/5 border border-dashed border-[#e94560]/30 rounded-lg":"hover:bg-white/[0.02]"),children:[(0,l.jsx)("div",{className:"absolute -left-7 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-grab active:cursor-grabbing",children:(0,l.jsx)("span",{className:"text-text-inactive text-[10px]",children:"⋮⋮"})}),ew(e),M&&q===e.id&&(0,l.jsxs)("div",{ref:U,className:"absolute left-0 top-full z-50 mt-1 w-72 bg-background-card border border-border rounded-xl shadow-2xl overflow-hidden",style:{maxHeight:"280px"},children:[(0,l.jsx)("div",{className:"p-2 border-b border-border",children:(0,l.jsx)("p",{className:"text-[10px] text-text-muted font-semibold uppercase tracking-wider px-2",children:"블록 타입 선택"})}),(0,l.jsxs)("div",{className:"overflow-y-auto",style:{maxHeight:"240px"},children:[eh.map((e,t)=>(0,l.jsxs)("button",{onClick:()=>eb(e.type),onMouseEnter:()=>Q(t),className:"w-full flex items-center gap-3 px-3 py-2 text-left transition-colors ".concat(W===t?"bg-[#e94560]/10 text-[#e94560]":"text-text-secondary hover:bg-background-hover"),children:[(0,l.jsx)("span",{className:"w-8 h-8 flex items-center justify-center bg-border/50 rounded-lg text-xs font-mono flex-shrink-0",children:e.icon}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs font-semibold",children:e.label}),(0,l.jsx)("p",{className:"text-[10px] text-text-muted",children:e.desc})]})]},e.type)),0===eh.length&&(0,l.jsx)("p",{className:"text-xs text-text-muted text-center py-4",children:"일치하는 블록 타입이 없습니다"})]})]})]},e.id))}),(0,l.jsxs)("button",{onClick:()=>{eu(V.blocks[V.blocks.length-1].id)},className:"mt-4 w-full py-2 text-text-inactive hover:text-text-secondary text-sm text-left transition-colors",children:[t("notes.newBlock")," \xa0 ",(0,l.jsx)("span",{className:"text-[10px] opacity-50",children:"Enter로도 추가 가능 \xb7 / 로 블록 타입 선택"})]}),(0,l.jsxs)("div",{className:"mt-12 p-4 bg-background border border-border/50 rounded-xl",children:[(0,l.jsx)("div",{className:"text-[10px] text-text-inactive uppercase tracking-wider font-semibold mb-3",children:t("notes.shortcuts")}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1.5 text-[11px] text-text-muted",children:[{key:"/",desc:"블록 선택"},{key:"#",desc:"제목 1"},{key:"##",desc:"제목 2"},{key:"###",desc:"제목 3"},{key:"-",desc:"글머리"},{key:"1.",desc:"번호"},{key:"[]",desc:"체크리스트"},{key:">",desc:"인용문"},{key:"---",desc:"구분선"},{key:"```",desc:"코드"},{key:"[[",desc:"링크"},{key:">>",desc:"토글"}].map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)("code",{className:"px-1 py-0.5 bg-border/50 rounded text-[9px] text-[#e94560]/70 font-mono min-w-[2em] text-center",children:e.key}),(0,l.jsx)("span",{children:e.desc})]},t))})]})]})})]}):(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-6xl mb-4 animate-pulse-slow",children:"\uD83D\uDCDD"}),(0,l.jsx)("p",{className:"text-text-secondary font-semibold text-lg",children:t("notes.selectNote")}),(0,l.jsx)("p",{className:"text-text-muted text-sm mt-1",children:t("notes.orCreate")}),(0,l.jsx)("button",{onClick:()=>$(),className:"mt-4 px-5 py-2.5 bg-[#e94560] hover:bg-[#ff5a7a] text-white font-semibold rounded-xl text-sm transition-colors",children:t("notes.newNote")})]})})]})}function x(e){let{note:t,isActive:n,onClick:a,onDelete:r,onTogglePin:o,getRelativeTime:i,indent:s}=e,d=t.blocks.filter(e=>"divider"!==e.type&&e.content).slice(0,1).map(e=>e.content).join("");return(0,l.jsxs)("div",{onClick:a,className:"group relative flex items-center gap-2 py-1.5 pr-2 rounded-lg cursor-pointer transition-all mx-2 ".concat(s>0?"pl-8":"pl-3"," ").concat(n?"bg-background-card border border-[#e94560]/30":"hover:bg-background-card/60 border border-transparent"),children:[(0,l.jsx)("span",{className:"text-base flex-shrink-0",children:t.icon}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"text-xs font-semibold text-text-primary truncate",children:t.title}),d&&(0,l.jsx)("p",{className:"text-[10px] text-text-inactive truncate",children:d}),(0,l.jsx)("p",{className:"text-[9px] text-text-inactive",children:i(t.updated_at)})]}),(0,l.jsxs)("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 flex gap-0.5",children:[(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),o()},className:"w-5 h-5 flex items-center justify-center rounded text-[10px] ".concat(t.pinned?"text-[#e94560]":"text-text-muted hover:text-[#e94560]"),children:"\uD83D\uDCCC"}),(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),r()},className:"w-5 h-5 flex items-center justify-center rounded text-text-muted hover:text-[#e94560] text-xs",children:"\xd7"})]})]})}}},function(e){e.O(0,[815,419,994,936,407,809,744],function(){return e(e.s=5189)}),_N_E=e.O()}]);