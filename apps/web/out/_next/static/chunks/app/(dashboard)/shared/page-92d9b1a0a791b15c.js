(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[608],{6630:function(e,t,r){Promise.resolve().then(r.bind(r,7394))},7394:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var s=r(7573),l=r(7653),a=r(4193),o=r(9937),n=r(6921);let d=["#e94560","#8b5cf6","#06b6d4","#22c55e","#f59e0b","#ec4899"],i=["\uD83D\uDCCB","\uD83C\uDFA8","\uD83D\uDED2","\uD83D\uDCDA","\uD83D\uDCBC","\uD83C\uDFE0","\uD83C\uDFAF","\uD83D\uDD2C"],c={view:{label:"보기",color:"#64748b"},edit:{label:"편집",color:"#8b5cf6"},admin:{label:"관리자",color:"#e94560"}};function x(){let{user:e}=(0,a.a)(),{t}=(0,o.QT)(),[x,m]=(0,l.useState)([]),[u,h]=(0,l.useState)(!0),[b,p]=(0,l.useState)(!1),[f,v]=(0,l.useState)(""),[j,g]=(0,l.useState)(null),[y,N]=(0,l.useState)([]),[w,k]=(0,l.useState)(""),[D,C]=(0,l.useState)(null),[F,S]=(0,l.useState)(""),[E,_]=(0,l.useState)("edit"),L=(0,l.useCallback)(async()=>{if(e)try{let t=await (0,n.vh)(e.uid);m(t)}catch(e){console.error("Failed to load shared lists:",e)}finally{h(!1)}},[e]);(0,l.useEffect)(()=>{L()},[L]);let A=(0,l.useCallback)(async e=>{try{let t=await (0,n.go)(e);N(t)}catch(e){console.error("Failed to load shared tasks:",e)}},[]);(0,l.useEffect)(()=>{j&&A(j)},[j,A]);let B=async()=>{if(!e||!f.trim())return;let t=d[x.length%d.length],r=i[x.length%i.length];try{await (0,n.Vs)(e.uid,{name:f.trim(),color:t,icon:r,ownerName:e.displayName||"사용자",ownerEmail:e.email||""}),v(""),p(!1),L()}catch(e){console.error("Failed to create shared list:",e)}},O=async e=>{if(confirm("이 공유 목록을 삭제할까요?"))try{await (0,n.Of)(e),j===e&&g(null),L()}catch(e){console.error("Failed to delete shared list:",e)}},P=async()=>{if(j&&w.trim())try{await (0,n.jH)(j,{title:w.trim(),status:"todo",priority:"medium",starred:!1,listId:j,myDay:!1}),k(""),A(j)}catch(e){console.error("Failed to add shared task:",e)}},U=async e=>{if(!j||!e.id)return;let t="completed"===e.status?"todo":"completed";N(r=>r.map(r=>r.id===e.id?{...r,status:t}:r)),await (0,n.Fg)(j,e.id,{status:t})},K=async e=>{j&&(N(t=>t.filter(t=>t.id!==e)),await (0,n.SW)(j,e))},z=async()=>{if(D&&F.trim())try{let{inviteToSharedList:e}=await Promise.resolve().then(r.bind(r,6921));await e(D,{uid:"invited-".concat(Date.now()),email:F.trim(),name:F.split("@")[0],permission:E,joinedAt:new Date().toISOString()}),S(""),C(null),L()}catch(e){console.error("Failed to invite:",e)}},I=t=>{var r;if(t.ownerUid===(null==e?void 0:e.uid))return"admin";let s=null===(r=t.members)||void 0===r?void 0:r.find(t=>t.uid===(null==e?void 0:e.uid));return(null==s?void 0:s.permission)||"view"};if(u)return(0,s.jsx)("div",{className:"p-8 flex items-center justify-center min-h-[50vh]",children:(0,s.jsx)("div",{className:"w-6 h-6 border-2 border-[#e94560] border-t-transparent rounded-full animate-spin"})});let W=x.find(e=>e.id===j);return(0,s.jsx)("div",{className:"p-4 md:p-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDC65"}),(0,s.jsx)("h2",{className:"text-3xl font-extrabold text-text-primary",children:t("shared.title")})]}),(0,s.jsx)("p",{className:"text-text-secondary text-sm",children:t("shared.desc")})]}),(0,s.jsxs)("div",{className:"flex gap-6",children:[(0,s.jsxs)("div",{className:"w-80 flex-shrink-0",children:[(0,s.jsx)("div",{className:"space-y-3",children:x.map((t,r)=>{var l,a,o,n,d,i,x,m;let u=c[I(t)]||c.view,h=j===t.id;return(0,s.jsxs)("div",{onClick:()=>g(t.id),className:"p-4 bg-background-card border rounded-xl transition-all cursor-pointer group ".concat(h?"border-[#e94560]/40 shadow-[0_0_12px_rgba(233,69,96,0.1)]":"border-border hover:border-border-hover"),style:{animation:"fadeUp 0.4s ease-out both",animationDelay:"".concat(.05*r,"s")},children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-lg flex-shrink-0",style:{backgroundColor:"".concat(t.color,"20")},children:t.icon}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-text-primary truncate",children:t.name}),(0,s.jsx)("span",{className:"text-[9px] px-2 py-0.5 rounded-full font-semibold",style:{color:u.color,backgroundColor:"".concat(u.color,"20")},children:u.label})]}),(0,s.jsxs)("p",{className:"text-[11px] text-text-muted",children:[t.ownerName," \xb7 ",(null!==(i=null===(l=t.members)||void 0===l?void 0:l.length)&&void 0!==i?i:0)+1,"명"]})]}),(0,s.jsxs)("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),C(t.id)},className:"w-6 h-6 flex items-center justify-center text-text-muted hover:text-[#8b5cf6] text-xs",title:"초대",children:"✉️"}),t.ownerUid===(null==e?void 0:e.uid)&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),O(t.id)},className:"w-6 h-6 flex items-center justify-center text-text-muted hover:text-[#e94560] text-xs",children:"\xd7"})]})]}),(0,s.jsxs)("div",{className:"flex -space-x-2 mt-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded-full border-2 border-background-card flex items-center justify-center text-[8px] font-bold text-white",style:{backgroundColor:t.color},children:(null===(a=t.ownerName)||void 0===a?void 0:a[0])||"?"}),null===(o=t.members)||void 0===o?void 0:o.slice(0,3).map((e,t)=>{var r;return(0,s.jsx)("div",{className:"w-6 h-6 rounded-full border-2 border-background-card flex items-center justify-center text-[8px] font-bold text-white",style:{backgroundColor:["#8b5cf6","#06b6d4","#22c55e"][t%3]},children:(null===(r=e.name)||void 0===r?void 0:r[0])||"?"},t)}),(null!==(x=null===(n=t.members)||void 0===n?void 0:n.length)&&void 0!==x?x:0)>3&&(0,s.jsxs)("div",{className:"w-6 h-6 rounded-full border-2 border-background-card bg-border flex items-center justify-center text-[8px] text-text-secondary",children:["+",(null!==(m=null===(d=t.members)||void 0===d?void 0:d.length)&&void 0!==m?m:0)-3]})]})]},t.id)})}),b?(0,s.jsxs)("div",{className:"mt-4 p-4 border border-border rounded-xl bg-background-card",children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>v(e.target.value),onKeyDown:e=>"Enter"===e.key&&B(),placeholder:"공유 목록 이름...",autoFocus:!0,className:"w-full px-3 py-2 bg-background border border-border rounded-lg text-sm text-text-primary placeholder-text-muted focus:outline-none focus:border-[#e94560] mb-2"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:B,className:"flex-1 py-2 bg-[#e94560] text-white rounded-lg text-xs font-semibold hover:bg-[#ff5a7a]",children:t("common.add")}),(0,s.jsx)("button",{onClick:()=>p(!1),className:"px-3 py-2 text-text-muted text-xs",children:t("common.cancel")})]})]}):(0,s.jsxs)("button",{onClick:()=>p(!0),className:"mt-4 w-full p-4 border-2 border-dashed border-border rounded-xl text-center hover:border-[#e94560]/30 transition-colors cursor-pointer group",children:[(0,s.jsx)("div",{className:"text-2xl mb-1",children:"✉️"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-text-secondary group-hover:text-text-primary transition-colors",children:t("shared.newList")})]}),0===x.length&&!b&&(0,s.jsxs)("div",{className:"mt-8 text-center",children:[(0,s.jsx)("div",{className:"text-4xl mb-3",children:"\uD83D\uDC65"}),(0,s.jsx)("p",{className:"text-text-secondary font-semibold",children:t("shared.noLists")}),(0,s.jsx)("p",{className:"text-text-muted text-sm mt-1",children:t("shared.createFirst")})]})]}),(0,s.jsx)("div",{className:"flex-1",children:W?(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-lg",style:{backgroundColor:"".concat(W.color,"20")},children:W.icon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-text-primary",children:W.name}),(0,s.jsxs)("p",{className:"text-xs text-text-muted",children:[y.length,"개 작업"]})]})]}),(0,s.jsxs)("div",{className:"mb-4 flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:w,onChange:e=>k(e.target.value),onKeyDown:e=>"Enter"===e.key&&P(),placeholder:"+ 새 작업 추가...",className:"flex-1 px-4 py-2.5 bg-background-card border border-border rounded-xl text-sm text-text-primary placeholder-text-muted focus:outline-none focus:border-[#e94560]"}),(0,s.jsx)("button",{onClick:P,className:"px-4 py-2.5 bg-[#e94560] text-white rounded-xl text-sm font-semibold hover:bg-[#ff5a7a]",children:t("common.add")})]}),(0,s.jsx)("div",{className:"space-y-2",children:y.map(e=>{let t="completed"===e.status;return(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-background-card border border-border rounded-xl group hover:border-border-hover transition-all",children:[(0,s.jsx)("button",{onClick:()=>U(e),className:"w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all flex-shrink-0 ".concat(t?"bg-gradient-to-br from-[#e94560] to-[#533483] border-transparent":"hover:border-[#e94560]"),style:t?void 0:{borderColor:"var(--color-checkbox-border)"},children:t&&(0,s.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 14 14",fill:"none",children:(0,s.jsx)("path",{d:"M3 7L6 10L11 4",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,s.jsx)("span",{className:"flex-1 text-sm ".concat(t?"line-through text-text-inactive":"text-text-primary"),children:e.title}),(0,s.jsx)("button",{onClick:()=>K(e.id),className:"opacity-0 group-hover:opacity-100 text-text-muted hover:text-[#e94560] text-sm transition-all",children:"\xd7"})]},e.id)})}),0===y.length&&(0,s.jsx)("div",{className:"text-center py-12 text-text-muted text-sm",children:"작업이 없습니다. 새 작업을 추가해보세요."})]}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full min-h-[300px]",children:(0,s.jsxs)("div",{className:"text-center text-text-muted",children:[(0,s.jsx)("div",{className:"text-4xl mb-3",children:"\uD83D\uDCCB"}),(0,s.jsx)("p",{className:"text-sm",children:"목록을 선택하세요"})]})})})]}),D&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 z-40 bg-black/30",onClick:()=>C(null)}),(0,s.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 w-96 bg-background-card border border-border rounded-2xl p-6 shadow-2xl",style:{animation:"fadeUp 0.2s ease-out"},children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-text-primary mb-4",children:t("shared.invite")}),(0,s.jsx)("input",{type:"email",value:F,onChange:e=>S(e.target.value),onKeyDown:e=>"Enter"===e.key&&z(),placeholder:"이메일 주소...",autoFocus:!0,className:"w-full px-3 py-2.5 bg-background border border-border rounded-lg text-sm text-text-primary placeholder-text-muted focus:outline-none focus:border-[#e94560] mb-3"}),(0,s.jsx)("div",{className:"flex gap-2 mb-4",children:["view","edit"].map(e=>(0,s.jsx)("button",{onClick:()=>_(e),className:"flex-1 py-2 rounded-lg text-xs font-semibold border transition-all ".concat(E===e?"border-[#e94560] bg-[#e94560]/10 text-[#e94560]":"border-border text-text-secondary"),children:c[e].label},e))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:z,className:"flex-1 py-2.5 bg-[#e94560] text-white rounded-xl text-sm font-semibold hover:bg-[#ff5a7a]",children:"초대 보내기"}),(0,s.jsx)("button",{onClick:()=>C(null),className:"px-4 py-2.5 text-text-muted text-sm",children:t("common.cancel")})]})]})]})]})})}}},function(e){e.O(0,[301,787,419,937,293,528,744],function(){return e(e.s=6630)}),_N_E=e.O()}]);