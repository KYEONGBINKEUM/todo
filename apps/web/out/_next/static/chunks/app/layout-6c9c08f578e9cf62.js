(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4872:function(e,t,s){Promise.resolve().then(s.t.bind(s,4085,23)),Promise.resolve().then(s.bind(s,7637))},7637:function(e,t,s){"use strict";s.d(t,{Providers:function(){return c}});var r=s(6717),n=s(1097),i=s(7541),o=s(9936),d=s(1730);function c(e){let{children:t}=e;return(0,r.jsx)(n.H,{children:(0,r.jsx)(i.f,{children:(0,r.jsx)(o.bd,{children:(0,r.jsx)(d.P,{children:t})})})})}},1730:function(e,t,s){"use strict";s.d(t,{P:function(){return a},a:function(){return l}});var r=s(6717),n=s(7387),i=s(7253),o=s(1579),d=s(1097);let c=(0,n.createContext)({tasks:[],lists:[],notes:[],folders:[],mindmaps:[],loading:!0,storageUsed:0});function u(e){return new Blob([e]).size}function a(e){let{children:t}=e,{user:s,loading:a}=(0,d.a)(),[l,f]=(0,n.useState)([]),[h,m]=(0,n.useState)([]),[v,g]=(0,n.useState)([]),[k,b]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[E,S]=(0,n.useState)(!0),L=(0,n.useRef)([]);(0,n.useEffect)(()=>{if(a)return;if(L.current.forEach(e=>e()),L.current=[],!s){f([]),m([]),g([]),b([]),x([]),S(!1);return}S(!0);let e=s.uid,t=0,r=()=>{++t>=5&&S(!1)},n=(0,i.cf)((0,i.IO)((0,i.hJ)(o.db,"users",e,"tasks"),(0,i.Xo)("createdAt","desc")),e=>{f(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),d=(0,i.cf)((0,i.hJ)(o.db,"users",e,"lists"),e=>{m(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),c=(0,i.cf)((0,i.IO)((0,i.hJ)(o.db,"users",e,"notes"),(0,i.Xo)("createdAt","desc")),e=>{g(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),u=(0,i.cf)((0,i.hJ)(o.db,"users",e,"folders"),e=>{b(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),l=(0,i.cf)((0,i.IO)((0,i.hJ)(o.db,"users",e,"mindmaps"),(0,i.Xo)("createdAt","desc")),e=>{x(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r());return L.current=[n,d,c,u,l],()=>{L.current.forEach(e=>e()),L.current=[]}},[s,a]);let w=function(e,t,s){var r,n,i,o;let d=0;for(let t of e){for(let e of(d+=u(t.title||"")+u(t.memo||""),null!==(r=t.subTasks)&&void 0!==r?r:[]))d+=u(e.title||"");for(let e of null!==(n=t.attachments)&&void 0!==n?n:[])d+=e.size}for(let e of t)for(let t of(d+=u(e.title||""),null!==(i=e.blocks)&&void 0!==i?i:[]))d+=u(t.content||"")+u(t.children||"");for(let e of s)for(let t of(d+=u(e.title||""),null!==(o=e.nodes)&&void 0!==o?o:[]))d+=u(t.text||""),t.imageSize&&(d+=t.imageSize);return d}(l,v,p);return(0,r.jsx)(c.Provider,{value:{tasks:l,lists:h,notes:v,folders:k,mindmaps:p,loading:E,storageUsed:w},children:t})}function l(){return(0,n.useContext)(c)}},7541:function(e,t,s){"use strict";s.d(t,{F:function(){return a},f:function(){return u}});var r=s(6717),n=s(7387),i=s(1097),o=s(6813);let d=(0,n.createContext)({theme:"system",setTheme:()=>{}});function c(e){let t=document.documentElement;if("light"===e)t.classList.add("light"),t.classList.remove("dark");else if("dark"===e)t.classList.add("dark"),t.classList.remove("light");else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches;t.classList.toggle("dark",e),t.classList.toggle("light",!e)}}function u(e){let{children:t}=e,{user:s}=(0,i.a)(),[u,a]=(0,n.useState)("system");return(0,n.useEffect)(()=>{s&&(0,o.nS)(s.uid).then(e=>{a(e.theme),c(e.theme)})},[s]),(0,n.useEffect)(()=>{if("system"!==u)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>c("system");return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[u]),(0,r.jsx)(d.Provider,{value:{theme:u,setTheme:e=>{a(e),c(e),s&&(0,o.d2)(s.uid,{theme:e})}},children:t})}let a=()=>(0,n.useContext)(d)},4085:function(){}},function(e){e.O(0,[942,815,419,412,936,407,809,744],function(){return e(e.s=4872)}),_N_E=e.O()}]);