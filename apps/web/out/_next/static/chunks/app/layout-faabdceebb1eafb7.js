(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4872:function(e,t,s){Promise.resolve().then(s.t.bind(s,4085,23)),Promise.resolve().then(s.bind(s,7637))},7637:function(e,t,s){"use strict";s.d(t,{Providers:function(){return o}});var r=s(6717),n=s(1097),i=s(7541),c=s(9936),d=s(1730);function o(e){let{children:t}=e;return(0,r.jsx)(n.H,{children:(0,r.jsx)(i.f,{children:(0,r.jsx)(c.bd,{children:(0,r.jsx)(d.P,{children:t})})})})}},1730:function(e,t,s){"use strict";s.d(t,{P:function(){return a},a:function(){return l}});var r=s(6717),n=s(7387),i=s(7253),c=s(1579),d=s(1097);let o=(0,n.createContext)({tasks:[],lists:[],notes:[],folders:[],mindmaps:[],loading:!0,storageUsed:0});function u(e){return new Blob([e]).size}function a(e){let{children:t}=e,{user:s,loading:a}=(0,d.a)(),[l,f]=(0,n.useState)([]),[h,m]=(0,n.useState)([]),[v,k]=(0,n.useState)([]),[b,g]=(0,n.useState)([]),[p,E]=(0,n.useState)([]),[x,L]=(0,n.useState)(!0),S=(0,n.useRef)([]);(0,n.useEffect)(()=>{if(a)return;if(S.current.forEach(e=>e()),S.current=[],!s){f([]),m([]),k([]),g([]),E([]),L(!1);return}L(!0);let e=s.uid,t=0,r=()=>{++t>=5&&L(!1)},n=(0,i.cf)((0,i.IO)((0,i.hJ)(c.db,"users",e,"tasks"),(0,i.Xo)("createdAt","desc")),e=>{f(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),d=(0,i.cf)((0,i.hJ)(c.db,"users",e,"lists"),e=>{m(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),o=(0,i.cf)((0,i.IO)((0,i.hJ)(c.db,"users",e,"notes"),(0,i.Xo)("createdAt","desc")),e=>{k(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),u=(0,i.cf)((0,i.hJ)(c.db,"users",e,"folders"),e=>{g(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),l=(0,i.cf)((0,i.IO)((0,i.hJ)(c.db,"users",e,"mindmaps"),(0,i.Xo)("createdAt","desc")),e=>{E(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r());return S.current=[n,d,o,u,l],()=>{S.current.forEach(e=>e()),S.current=[]}},[s,a]);let w=function(e,t){var s,r,n;let i=0;for(let t of e){for(let e of(i+=u(t.title||"")+u(t.memo||""),null!==(s=t.subTasks)&&void 0!==s?s:[]))i+=u(e.title||"");for(let e of null!==(r=t.attachments)&&void 0!==r?r:[])i+=e.size}for(let e of t)for(let t of(i+=u(e.title||""),null!==(n=e.blocks)&&void 0!==n?n:[]))i+=u(t.content||"")+u(t.children||"");return i}(l,v);return(0,r.jsx)(o.Provider,{value:{tasks:l,lists:h,notes:v,folders:b,mindmaps:p,loading:x,storageUsed:w},children:t})}function l(){return(0,n.useContext)(o)}},7541:function(e,t,s){"use strict";s.d(t,{F:function(){return a},f:function(){return u}});var r=s(6717),n=s(7387),i=s(1097),c=s(6813);let d=(0,n.createContext)({theme:"system",setTheme:()=>{}});function o(e){let t=document.documentElement;if("light"===e)t.classList.add("light"),t.classList.remove("dark");else if("dark"===e)t.classList.add("dark"),t.classList.remove("light");else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches;t.classList.toggle("dark",e),t.classList.toggle("light",!e)}}function u(e){let{children:t}=e,{user:s}=(0,i.a)(),[u,a]=(0,n.useState)("system");return(0,n.useEffect)(()=>{s&&(0,c.nS)(s.uid).then(e=>{a(e.theme),o(e.theme)})},[s]),(0,n.useEffect)(()=>{if("system"!==u)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>o("system");return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[u]),(0,r.jsx)(d.Provider,{value:{theme:u,setTheme:e=>{a(e),o(e),s&&(0,c.d2)(s.uid,{theme:e})}},children:t})}let a=()=>(0,n.useContext)(d)},4085:function(){}},function(e){e.O(0,[942,815,419,412,936,407,809,744],function(){return e(e.s=4872)}),_N_E=e.O()}]);