(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4872:function(e,t,s){Promise.resolve().then(s.t.bind(s,4085,23)),Promise.resolve().then(s.bind(s,7637))},7637:function(e,t,s){"use strict";s.d(t,{Providers:function(){return u}});var r=s(6717),n=s(1097),i=s(7541),c=s(9936),o=s(1730);function u(e){let{children:t}=e;return(0,r.jsx)(n.H,{children:(0,r.jsx)(i.f,{children:(0,r.jsx)(c.bd,{children:(0,r.jsx)(o.P,{children:t})})})})}},1730:function(e,t,s){"use strict";s.d(t,{P:function(){return a},a:function(){return l}});var r=s(6717),n=s(7387),i=s(7253),c=s(1579),o=s(1097);let u=(0,n.createContext)({tasks:[],lists:[],notes:[],folders:[],loading:!0,storageUsed:0});function d(e){return new Blob([e]).size}function a(e){let{children:t}=e,{user:s,loading:a}=(0,o.a)(),[l,f]=(0,n.useState)([]),[h,m]=(0,n.useState)([]),[v,k]=(0,n.useState)([]),[g,b]=(0,n.useState)([]),[E,x]=(0,n.useState)(!0),p=(0,n.useRef)([]);(0,n.useEffect)(()=>{if(a)return;if(p.current.forEach(e=>e()),p.current=[],!s){f([]),m([]),k([]),b([]),x(!1);return}x(!0);let e=s.uid,t=0,r=()=>{++t>=4&&x(!1)},n=(0,i.cf)((0,i.IO)((0,i.hJ)(c.db,"users",e,"tasks"),(0,i.Xo)("createdAt","desc")),e=>{f(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),o=(0,i.cf)((0,i.hJ)(c.db,"users",e,"lists"),e=>{m(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),u=(0,i.cf)((0,i.IO)((0,i.hJ)(c.db,"users",e,"notes"),(0,i.Xo)("createdAt","desc")),e=>{k(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r()),d=(0,i.cf)((0,i.hJ)(c.db,"users",e,"folders"),e=>{b(e.docs.map(e=>({id:e.id,...e.data()}))),r()},()=>r());return p.current=[n,o,u,d],()=>{p.current.forEach(e=>e()),p.current=[]}},[s,a]);let L=function(e,t){var s,r,n;let i=0;for(let t of e){for(let e of(i+=d(t.title||"")+d(t.memo||""),null!==(s=t.subTasks)&&void 0!==s?s:[]))i+=d(e.title||"");for(let e of null!==(r=t.attachments)&&void 0!==r?r:[])i+=e.size}for(let e of t)for(let t of(i+=d(e.title||""),null!==(n=e.blocks)&&void 0!==n?n:[]))i+=d(t.content||"")+d(t.children||"");return i}(l,v);return(0,r.jsx)(u.Provider,{value:{tasks:l,lists:h,notes:v,folders:g,loading:E,storageUsed:L},children:t})}function l(){return(0,n.useContext)(u)}},7541:function(e,t,s){"use strict";s.d(t,{F:function(){return a},f:function(){return d}});var r=s(6717),n=s(7387),i=s(1097),c=s(6813);let o=(0,n.createContext)({theme:"system",setTheme:()=>{}});function u(e){let t=document.documentElement;if("light"===e)t.classList.add("light"),t.classList.remove("dark");else if("dark"===e)t.classList.add("dark"),t.classList.remove("light");else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches;t.classList.toggle("dark",e),t.classList.toggle("light",!e)}}function d(e){let{children:t}=e,{user:s}=(0,i.a)(),[d,a]=(0,n.useState)("system");return(0,n.useEffect)(()=>{s&&(0,c.nS)(s.uid).then(e=>{a(e.theme),u(e.theme)})},[s]),(0,n.useEffect)(()=>{if("system"!==d)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>u("system");return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[d]),(0,r.jsx)(o.Provider,{value:{theme:d,setTheme:e=>{a(e),u(e),s&&(0,c.d2)(s.uid,{theme:e})}},children:t})}let a=()=>(0,n.useContext)(o)},4085:function(){}},function(e){e.O(0,[942,815,419,412,936,407,809,744],function(){return e(e.s=4872)}),_N_E=e.O()}]);